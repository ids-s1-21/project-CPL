---
title: "Project proposal"
author: "CPL"
output: github_document
---

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
olympics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-07-27/olympics.csv')
```

*For instructions on what each section should include, please see the [project page](https://idsed.digital/assessments/project/#proposal) on the course website. Remove this text when completing your proposal*.

## 1. Introduction

We got this dataset from Tidytuesday, and it was collected by JThomasmock from www.sports-reference.com. 

Each case is the athletes, and the variables are id, name, sex, age, height, weight, team, noc, games, year.

General research question:

1. Are younger athletes more likely to have a better performance than older athletes? 
 
2.Does the athletes from the host country tends to behave better by gaining more medals?

## 2. Data

```{r}
glimpse(olympics)
```

## 3. Data analysis plan

Are younger athletes more likely to have a better performance than older athletes? 
  ggplot(aes(x = age, y = n)) +
  geom_line() +
  facet_grid(~medal)

```{r}
population <- olympics %>%
  count(age)

medal_by_age <- olympics %>%
  na.omit(medal) %>%
  group_by(age) %>%
  mutate(n_medal = medal %in% c("Bronze", "Silver", "Gold")) %>%
  count(n_medal) %>%
  select(age, n) 

medal_by_age_2 <- medal_by_age %>%
  left_join(population, by = "age")

medal_by_age_2 %>%
  mutate(proportion = n.x/n.y) %>%
  ggplot(aes(x = age, y = proportion)) +
  geom_line()

```



Which team tends to perform better in Winter Olympics than Summer Olympics? 
```{r}
total_medal_by_team <- olympics %>%
  group_by(team) %>%
  select(team, season, medal) %>%
  na.omit(medal) %>%
  mutate(n_medal = medal %in% c("Bronze", "Silver", "Gold")) %>%
  count(n_medal) %>%
  select(team, n)

winter_medal_by_team <- olympics %>%
  group_by(team) %>%
  select(team, season, medal) %>%
  filter(season == "Winter") %>%
  na.omit(medal) %>%
  mutate(n_medal = medal %in% c("Bronze", "Silver", "Gold")) %>%
  count(n_medal) %>%
  select(team, n)
  
winter_medal_by_team %>%
  left_join(total_medal_by_team, by = "team") %>%
  mutate(proportion = n.x/n.y) %>%
  arrange(desc(proportion)) %>%
  filter(n.y >=100)


```






